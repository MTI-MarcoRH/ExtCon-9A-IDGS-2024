TABLA CATALOGO CONSUMIBLES 
La tabla `tbc_consumibles` utiliza datos estáticos para asegurar la estabilidad y consistencia de la información 
sobre los consumibles en nuestro sistema hospitalario. Esto nos ayuda a gestionar el inventario de manera más eficiente, 
manteniendo una base de datos uniforme y fácil de auditar. Además, al evitar cambios frecuentes, mejoramos el rendimiento
del sistema y garantizamos que siempre tengamos los recursos necesarios disponibles.



TABLA DERIVADA CIRUGIA CONSUMIBLES

CREATE DEFINER=`daniela.aguilar`@`%` PROCEDURE `sp_poblar_cirugia_consumibles_dinamico`(v_cantidad INT)
BEGIN
DECLARE i INT DEFAULT 1;
DECLARE v_cirugia_id INT;
Declare v_consumible_id int;
Declare v_cantidad_utilizada int;
DECLARE v_fecha_registro DATETIME DEFAULT NULL;

-- Crea una variable para guardar el ID de la persona y espacio médico aleatorios
    
    DECLARE v_cirugia_cursor CURSOR FOR SELECT ID FROM tbb_cirugias ORDER BY RAND() LIMIT 1;
	DECLARE v_consumible_cursor CURSOR FOR SELECT ID FROM tbc_consumibles ORDER BY RAND() LIMIT 1;
    
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET v_cirugia_id = NULL, v_consumible_id = NULL;

WHILE (i <= v_cantidad) DO
        -- Obtener paciente y espacio médico aleatorios

        OPEN v_cirugia_cursor;
        FETCH v_cirugia_cursor INTO v_cirugia_id;
        CLOSE v_cirugia_cursor;
        
		OPEN v_consumible_cursor;
        FETCH v_consumible_cursor INTO v_consumible_id;
        CLOSE v_consumible_cursor;
        
        
         SET v_fecha_registro = CURDATE();
         SET v_cantidad_utilizada = generarNumeroAleatorio(1,2000);
         
          -- Insertar la cirugia consumible en la tabla
        INSERT INTO tbd_cirugia_consumibles (ID, cirugia_id, consumible_id, Cantidad_Utilizada, Fecha_Registro) 
        VALUES (default, v_cirugia_id, v_consumible_id, v_cantidad_utilizada, NOW());
		
        
        SET i = i + 1;
    END WHILE;


END

